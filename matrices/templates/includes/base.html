<!DOCTYPE html>
<html lang="en">


{% load custom %}

{% load static %}

<head>

	<meta charset="utf-8">

	<link rel="apple-touch-icon" sizes="57x57" href="{% static 'apple-icon-57x57.png' %}">
	<link rel="apple-touch-icon" sizes="60x60" href="{% static 'apple-icon-60x60.png' %}">
	<link rel="apple-touch-icon" sizes="72x72" href="{% static 'apple-icon-72x72.png' %}">
	<link rel="apple-touch-icon" sizes="76x76" href="{% static 'apple-icon-76x76.png' %}">
	<link rel="apple-touch-icon" sizes="114x114" href="{% static 'apple-icon-114x114.png' %}">
	<link rel="apple-touch-icon" sizes="120x120" href="{% static 'apple-icon-120x120.png' %}">
	<link rel="apple-touch-icon" sizes="144x144" href="{% static 'apple-icon-144x144.png' %}">
	<link rel="apple-touch-icon" sizes="152x152" href="{% static 'apple-icon-152x152.png' %}">
	<link rel="apple-touch-icon" sizes="180x180" href="{% static 'apple-icon-180x180.png' %}">
	<link rel="icon" type="image/png" sizes="192x192"  href="{% static 'android-icon-192x192.png' %}">
	<link rel="shortcut icon" href="{% static 'favicon.ico' %}">
	<link rel="icon" type="image/png" sizes="32x32" href="{% static 'favicon-32x32.png' %}">
	<link rel="icon" type="image/png" sizes="96x96" href="{% static 'favicon-96x96.png' %}">
	<link rel="icon" type="image/png" sizes="16x16" href="{% static 'favicon-16x16.png' %}">
	<link rel="manifest" href="{% static 'manifest.json' %}">
	<meta name="msapplication-TileColor" content="#ffffff">
	<meta name="msapplication-TileImage" content="{% static 'ms-icon-144x144.png' %}">
	<meta name="theme-color" content="#ffffff">

	<link rel="stylesheet" href="{% static 'styles.css' %}">

	<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css">

	<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>	
	
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

	<title>{% block title %}Comparative Pathology Workbench{% endblock %}</title>
	
</head>

<body>

{% if settings.LOCATION == '' %}

	<!-- ><div class="container"> -->

    <header>
		
		<nav class="navbar navbar-expand-lg navbar-light">
        
            <a class="navbar-brand" href="{% url 'home' %}">
				<strong>Comparative Pathology Workbench</strong>
			</a>

{% elif settings.LOCATION == 'CANADA' %}

	<!-- <div class="container"> -->

    <header>
		
		<nav class="navbar navbar-expand-lg navbar-light" style="background-color: #f5776e;">
        
            <a class="navbar-brand" href="{% url 'home' %}">
				<strong>Comparative Pathology Workbench in CANADA</strong>
			</a>

{% elif settings.LOCATION == 'COELIAC' %}

	<!-- <div class="container"> -->

    <header>
		
		<nav class="navbar navbar-expand-lg navbar-light" style="background-color: #fcba03;">
        
            <a class="navbar-brand" href="{% url 'home' %}">
				<strong>Comparative Pathology Workbench for Coeliac Disease Data</strong>
			</a>

{% endif %}

			<button class="navbar-toggler d-lg-none" type="button" data-toggle="collapse" data-target="#navbarCollapseWholeMenu" aria-controls="navbarCollapseWholeMenu" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>

			<div class="collapse navbar-collapse" id="navbarCollapseWholeMenu">

				<ul class="navbar-nav mr-auto">

					<li class="nav-item dropdown">
	
{% if matrix_list and my_matrix_list %}

	{% if matrix_list %}

						<a class="nav-link dropdown-toggle" href="#" id="dropdown07" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">Benches ({{ matrix_list|length }})</a>
	
						<ul class="dropdown-menu" aria-labelledby="dropdown07">

			                <li class="dropdown-submenu">

		{% for matrix in matrix_list %}

			{% if forloop.first %}
		
			                    <a class="dropdown-item" href="{% url 'index' %}">List All Benches ({{ matrix_list|length }})</a>

			                    <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">All Benches</a>

			                    <ul class="dropdown-menu">	

			{% endif %}
			
									<li>

										<a class="dropdown-item" href="{% url 'matrix' matrix.matrix_id %}">CPW:{{ matrix.matrix_id|stringformat:"06d" }}, {{ matrix.matrix_title }}</a>

									</li>
	
			{% if forloop.last %}
		
			                    </ul>

			{% endif %}
			
		{% endfor %}

	{% else %}

						<a class="nav-link dropdown-toggle" href="#" id="dropdown07" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">Benches ({{ matrix_list|length }})</a>
	
						<ul class="dropdown-menu" aria-labelledby="dropdown07">

							<li><a class="dropdown-item" href="#">No Benches are available!</a></li>

			            </ul>
	{% endif %}


	{% if my_matrix_list %}

			                <li class="dropdown-submenu">

		{% for my_matrix in my_matrix_list %}

			{% if forloop.first %}
		
								<a class="dropdown-item" href="{% url 'list_matrix' %}">List My Benches ({{ my_matrix_list|length }})</a>

					            <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">My Benches</a>

			                    <ul class="dropdown-menu">	

			{% endif %}
			
								<li>
								
									<a class="dropdown-item" href="{% url 'matrix' my_matrix.matrix_id %}">CPW:{{ my_matrix.matrix_id|stringformat:"06d" }}, {{ my_matrix.matrix_title }}</a>
								
								</li>
	
			{% if forloop.last %}
		
			                    </ul>

			{% endif %}
			
		{% endfor %}
				            </li>

		{% if user.is_authenticated %}

			                <li class="dropdown-submenu">

								<a class="dropdown-item" href="{% url 'new_matrix' %}">Add New Bench</a>

				            </li>

		{% endif %}
	
			            </ul>

	{% else %}

						<a class="nav-link dropdown-toggle" href="#" id="dropdown07" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">Benches ({{ matrix_list|length }})</a>
	
						<ul class="dropdown-menu" aria-labelledby="dropdown07">

							<li>
							
								<a class="dropdown-item" href="#">No Benches are available!</a>
							
							</li>

			            </ul>

	{% endif %}


{% else %}

	{% if not matrix_list and not my_matrix_list%}
	
						<a class="nav-link dropdown-toggle" href="#" id="dropdown07" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">Benches</a>
	
						<ul class="dropdown-menu" aria-labelledby="dropdown07">

			{% if user.is_authenticated %}

			                <li class="dropdown-submenu">

								<a class="dropdown-item" href="{% url 'new_matrix' %}">Add New Bench</a>

				            </li>

			{% else %}
			
							<li>

								<a class="dropdown-item" href="#">No Benches are available!</a>

							</li>

			{% endif %}
	
			            </ul>

	{% else %}

						<a class="nav-link dropdown-toggle" href="#" id="dropdown07" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">Benches ({{ matrix_list|length }})</a>

						<ul class="dropdown-menu" aria-labelledby="dropdown07">

		{% if matrix_list %}

			                <li class="dropdown-submenu">

			{% for matrix in matrix_list %}

				{% if forloop.first %}
		
			                    <a class="dropdown-item" href="{% url 'index' %}">List All Benches ({{ matrix_list|length }})</a>

			                    <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">All Benches</a>

			                    <ul class="dropdown-menu">	

				{% endif %}
			
									<li>
									
										<a class="dropdown-item" href="{% url 'matrix' matrix.matrix_id %}">CPW:{{ matrix.matrix_id|stringformat:"06d" }}, {{ matrix.matrix_title }}</a>
									
									</li>
	
				{% if forloop.last %}
		
			                    </ul>

				{% endif %}
			
			{% endfor %}

		{% endif %}


		{% if my_matrix_list %}

			                <li class="dropdown-submenu">

			{% for my_matrix in my_matrix_list %}

				{% if forloop.first %}
		
								<a class="dropdown-item" href="{% url 'list_matrix' %}">List My Benches ({{ my_matrix_list|length }})</a>

					            <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">My Benches</a>

			                    <ul class="dropdown-menu">	

				{% endif %}
			
									<li>

										<a class="dropdown-item" href="{% url 'matrix' my_matrix.matrix_id %}">CPW:{{ my_matrix.matrix_id|stringformat:"06d" }}, {{ my_matrix.matrix_title }}</a>

									</li>
	
				{% if forloop.last %}
		
			                    </ul>

				{% endif %}
			
			{% endfor %}
				            </li>

			            </ul>

		{% else %}

			{% if user.is_authenticated %}

			                <li class="dropdown-submenu">

								<a class="dropdown-item" href="{% url 'new_matrix' %}">Add New Bench</a>

				            </li>

			{% endif %}
	
			            </ul>

		{% endif %}

	{% endif %}

{% endif %}

					</li>

					<li class="nav-item dropdown">
	
{% if server_list %}

						<a class="nav-link dropdown-toggle" href="#" id="dropdown07" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Sources ({{ server_list.count }})</a>
	
						<ul class="dropdown-menu" aria-labelledby="dropdown07">
					

		{% for server in server_list %}

			{% if forloop.first %}
		
							<li><a class="dropdown-item" href="{% url 'list_imaging_hosts' %}">All Sources</a></li>
			
			{% endif %}
			
			{% if server.type.name == 'WORDPRESS' %}
	
							<li><a class="dropdown-item" href="{% url 'webgallery_show_wordpress' server.id 1 %}">{{ server.name }}</a></li>

			{% else %}
	
							<li><a class="dropdown-item" href="{% url 'webgallery_show_imaging_server' server.id %}">{{ server.name }}</a></li>

			{% endif %}

	
		{% endfor %}

						</ul>

{% else %}

						<a class="nav-link dropdown-toggle" href="#" id="dropdown07" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Sources</a>
	
						<ul class="dropdown-menu" aria-labelledby="dropdown07">
					
							<li><a class="dropdown-item" href="#">No Sources are available!</a>

						</ul>

{% endif %}

					</li>

					<li class="nav-item dropdown">
	
{% if image_list %}

						<a class="nav-link dropdown-toggle" href="#" id="dropdown07" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Images ({{ image_list.count }})</a>
	
						<ul class="dropdown-menu" aria-labelledby="dropdown07">
					

		{% for image in image_list %}

			{% if forloop.first %}
		
							<li><a class="dropdown-item" href="{% url 'list_image_cart' %}">List Your Image Collection</a></li>
			
			{% endif %}

			{% if image.roi == 0 %}
			
				{% if image.server.type.name == 'WORDPRESS' %}

							<li><a class="dropdown-item" href="{% url 'webgallery_show_wordpress_image' image.server.id image.identifier %}">{{ image.identifier }}, {{ image.name }}</a></li>

				{% else %}
	
							<li><a class="dropdown-item" href="{% url 'webgallery_show_image' image.server.id image.identifier %}">{{ image.identifier }}, {{ image.name }}</a></li>
	
				{% endif %}
	
			{% else %}

							<li><a class="dropdown-item" href="{% url 'webgallery_show_image' image.server.id image.identifier %}">{{ image.identifier }}, {{ image.name }}, (ROI)</a></li>
	
			{% endif %}

		{% endfor %}

						</ul>
{% else %}

						<a class="nav-link dropdown-toggle" href="#" id="dropdown07" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Your Images</a>
	
						<ul class="dropdown-menu" aria-labelledby="dropdown07">
					
							<li><a class="dropdown-item" href="#">No Images are available!</a></li>

						</ul>

{% endif %}

					</li>

					<li class="nav-item dropdown">
	
						<a class="nav-link dropdown-toggle" href="#" id="dropdown07" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">About</a>
	
						<ul class="dropdown-menu" aria-labelledby="dropdown07">

							<li><a class="dropdown-item" href="{% url 'about' %}">About</a></li>
			
							<li><a class="dropdown-item" href="{% url 'people' %}">People</a></li>

							<li><a class="dropdown-item" href="{% url 'howto' %}">How To</a></li>

						</ul>

					</li>

				</ul>

				<ul class="navbar-nav ml-auto">

{% if user.is_authenticated %}

					<li class="nav-item dropdown">
			            
			            <a class="nav-link dropdown-toggle" href="#" id="dropdown01" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
			            	{{ user.username }}
			            </a>
            			
            			<ul class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdown01">

							<li><a class="dropdown-item" href="{% url 'detail_user' user.id %}">My account</a></li>
        		
							<li><a class="dropdown-item" href="{% url 'list_my_authorisation' %}">My Permissions</a></li>
        		
        		            <li><a class="dropdown-item" href="{% url 'password_change' %}">Change password</a></li>
				
							<li><a class="dropdown-item" href="{% url 'logout' %}">Logout</a></li>

	{% if user.is_superuser %}

							<li><a class="dropdown-item" href="{% url 'list_authorisation' %}">All Permissions</a></li>
        		
							<li><a class="dropdown-item" href="{% url 'maintenance' %}">Maintenance</a></li>

							<li><a class="dropdown-item" href="{% url 'authorisation' %}">Authorisation</a></li>

	{% endif %}

						</ul>

            		</li>
            		
{% else %}

					<li class="nav-item dropdown">
			            
			            <a class="nav-link dropdown-toggle" href="#" id="dropdown01" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
			            	User
			            </a>
            			
            			<ul class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdown01">

							<li><a class="dropdown-item" href="{% url 'login' %}">Login</a></li>

							<li><a class="dropdown-item" href="{% url 'signup' %}">Register</a></li>

						</ul>

            		</li>
            		
{% endif %}

				</ul>

            </div>

    	</nav>

	</header>
    

    <!-- <main role="main" class="container"> -->
    
    <main role="main">
    
	{% block content %}

	
	{% endblock %}
	
	</main>

<div class="row">

	<div class="col-md-1" id="sidebar">

	</div>

	<div class="col-md-9" id="content">

		<br />

		<hr>

	</div>

	<div class="col-md-2">

	</div>

</div>


<div class="row">

	<div class="col-md-1" id="sidebar">

	</div>

	<div class="col-md-1">

		<ul class="list-unstyled">
			<li>
				<a href="https://helmsleytrust.org/">
					<img src="{% static 'helmsley.png' %}" style="background-color: #FFFFFF;" width="170">
				</a>
			</li>
		</ul>

	</div>

	<div class="col-md-1">

	</div>
					
	<div class="col-md-1">

		<ul class="list-unstyled">
			<li>
				<a href="https://www.humancellatlas.org/">
					<img src="{% static 'HCA-logo-1500x500.jpeg' %}" style="background-color: #FFFFFF;" width="170">
				</a>
			</li>
		</ul>

	</div>
					
	<div class="col-md-1">
						
	</div>
					
	<div class="col-md-1">

		<ul class="list-unstyled">
			<li>
				<a href="https://www.ed.ac.uk/pathology">
					<img src="https://www.ed.ac.uk/sites/all/themes/uoe/assets/logo.png" style="background-color: #FFFFFF;" width="220">
				</a>
			</li>
		</ul>

	</div>
					
	<div class="col-md-1">

	</div>
					
	<div class="col-md-1">

		<ul class="list-unstyled">
			<li>
				<a href="https://www.hw.ac.uk/">
					<img src="{% static 'HW-Logo.jpg' %}" style="background-color: #FFFFFF;" width="125">
				</a>
			</li>
		</ul>

	</div>
					
	<div class="col-md-1">

	</div>
					
	<div class="col-md-1">

		<ul class="list-unstyled">
			<li>
				<a href="https://www.chanzuckerberg.com/">
					<img src="https://chanzuckerberg.com/wp-content/themes/czi/img/logo.svg" style="background-color: #FFFFFF;" width="125">
				</a>
			</li>
		</ul>

	</div>
					
					
	<div class="col-md-2">

	</div>

</div>


<script>

 $(document).ready(function(){
		$("textarea").attr({"rows": "10",
							"cols": "50"
		});
});


$(document).ready(function(){
	
	$("#matrix_info").on("hide.bs.collapse", function(){
		$(".toggle-info").html('<i class="fa fa-info fa-lg"></i>');
	});
	
	$("#matrix_info").on("show.bs.collapse", function(){
		$(".toggle-info").html('<i class="fa fa-window-minimize fa-lg"></i>');
	});

});


$( document ).ready( function () {
	$(".toggle-sidebar").click(function () {

		var flag = sessionStorage.getItem("sidebartoggle");
			
		//console.log("click BEFORE sessionStorage.sidebartoggle = ", flag)
	
		if (flag == "true") {
	
			//console.log("click Flag TRUE");

			sessionStorage.setItem("sidebartoggle", "false");
	
			$("#matrix_sidebar").removeClass("visible");
			$("#matrix_sidebar").addClass("invisible");
			$("#indicator-2").removeClass("fa-window-minimize");
			$("#indicator-2").addClass("fa-cart-arrow-down");
		}
		else {
	
			//console.log("click Flag FALSE");
		
			sessionStorage.setItem("sidebartoggle", "true");
	
			$("#matrix_sidebar").removeClass("invisible");
			$("#matrix_sidebar").addClass("visible");
			$("#indicator-2").removeClass("fa-cart-arrow-down");
			$("#indicator-2").addClass("fa-window-minimize");
		}

		return false;
	});
}); 

$( document ).ready( function () {

    window.onload = function (e) {

		//console.log("window.onload");

		if(sessionStorage) {
		
			var flag = sessionStorage.getItem("sidebartoggle");
			
			//console.log("onload sessionStorage.sidebartoggle = ", flag)

			if (flag == ""){
			
			    sessionStorage.setItem("sidebartoggle", "false");

				$("#matrix_sidebar").removeClass("visible");
				$("#matrix_sidebar").addClass("invisible");
				$("#indicator-2").removeClass("fa-window-minimize");
				$("#indicator-2").addClass("fa-cart-arrow-down");
			}
			else {
			
				if (flag == "true") {
	
					//console.log("Load Flag TRUE")

					$("#matrix_sidebar").removeClass("invisible");
					$("#matrix_sidebar").addClass("visible");
					$("#indicator-2").removeClass("fa-cart-arrow-down");
					$("#indicator-2").addClass("fa-window-minimize");
				}
				else {
	
					//console.log("Load Flag FALSE")
		
					$("#matrix_sidebar").removeClass("visible");
					$("#matrix_sidebar").addClass("invisible");
					$("#indicator-2").removeClass("fa-window-minimize");
					$("#indicator-2").addClass("fa-cart-arrow-down");
				}
			}
		}
    };
}); 


$( document ).ready( function () {
    $( '.dropdown-menu a.dropdown-toggle' ).on( 'click', function ( e ) {
        var $el = $( this );
        $el.toggleClass('active-dropdown');
        var $parent = $( this ).offsetParent( ".dropdown-menu" );
        if ( !$( this ).next().hasClass( 'show' ) ) {
            $( this ).parents( '.dropdown-menu' ).first().find( '.show' ).removeClass( "show" );
        }
        var $subMenu = $( this ).next( ".dropdown-menu" );
        $subMenu.toggleClass( 'show' );
        
        $( this ).parent( "li" ).toggleClass( 'show' );

        $( this ).parents( 'li.nav-item.dropdown.show' ).on( 'hidden.bs.dropdown', function ( e ) {
            $( '.dropdown-menu .show' ).removeClass( "show" );
            $el.removeClass('active-dropdown');
        } );
        
         if ( !$parent.parent().hasClass( 'navbar-nav' ) ) {
            $el.next().css( { "top": $el[0].offsetTop, "left": $parent.outerWidth() - 4 } );
        }

        return false;
    } );
} );	


</script>

		
</body>

</html>